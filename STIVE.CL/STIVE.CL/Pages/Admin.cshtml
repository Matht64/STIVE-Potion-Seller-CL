@page
@model STIVE.CL.Pages.AdminModel

@{
    ViewData["Title"] = "Admin";
}

<div class="text-center" xmlns="http://www.w3.org/1999/html">
    <div class="image-container position-relative pt-5 pb-5">
        <img src="image/Table.png" class="img-fluid" alt="Livre" style="width: 100%;"/>
        <div class="position-absolute overlay-div" style="top: 12%; left: 6%; width: 87%; height: auto;">
            <!-- User Button -->
            <a href="?table=users" class="button button-small" title="Utilisateurs">
                <i class="fas fa-user"></i>
            </a>

            <!-- Role Button -->
            <a href="?table=roles" class="button button-small" title="Rôles">
                <i class="fas fa-users"></i>
            </a>

            <!-- GameData Button -->
            <a href="?tables=gamedatas" class="button button-small" title="Données de jeu">
                <i class="fas fa-gamepad"></i>
            </a>

            <!-- Bonus Button -->
            <a href="?tables=bonus" class="button button-small" title="Bonus">
                <i class="fas fa-gift"></i>
            </a>

            <!-- GameDataBonus Button -->
            <a href="?tables=gamedatabonus" class="button button-small" title="Bonus des utilisateurs">
                <i class="fas fa-gift"></i>
            </a>

            <!-- Potion Button -->
            <a href="?tables=potions" class="button button-small" title="Potions">
                <i class="fas fa-flask"></i>
            </a>

            <!-- GameDataPotion Button -->
            <a href="?tables=gamedatapotions" class="button button-small" title="Potions des utilisateurs">
                <i class="fas fa-flask"></i>
            </a>

            <!-- Supplier Button -->
            <a href="?tables=suppliers" class="button button-small" title="Fournisseurs">
                <i class="fas fa-truck"></i>
            </a>

            <!-- GameDataSupplier Button -->
            <a href="?tables=gamedatasuppliers" class="button button-small" title="Fournisseurs des utilisateurs">
                <i class="fas fa-truck"></i>
            </a>

            <!-- Customer Button -->
            <a href="?tables=customers" class="button button-small" title="Clients">
                <i class="fa-solid fa-circle-user"></i>
            </a>
        </div>
        <div class="position-absolute overlay-div" style="top: 22%; left: 6%; width: 87%; height: auto;">
            @if (Model.TableToRender == "users")
            {
            <h2>Administration des utilisateurs</h2>
            <table class="table table-dark table-striped table-hover w-100">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Nom</th>
                    <th>Email</th>
                    <th>Tél</th>
                    <th>Rôle</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                @foreach (var user in Model.Users)
                {
                var formUserId = $"delete-form-{user.UserId}";
                <tr>
                    <td>@user.UserId</td>
                    <td>@user.UserName</td>
                    <td>@user.Email</td>
                    <td>@user.PhoneNumber</td>
                    <td>@string.Join(", ", user.Roles ?? new List<string>())</td>
                    <td>
                        <a asp-page="/UserUpdate" asp-route-id="@user.UserId" title="Mettre à jour" class="btn-dark me-2">
                            <i class="fas fa-edit"></i>
                        </a>
                        <form id="@formUserId" method="post" asp-page-handler="DeleteUser">
                            <input type="hidden" name="userId" value="@user.UserId"/>
                            <button type="button" class="btn btn-dark" onclick="confirmDelete('@formUserId')">
                                <i class="fas fa-times"></i>
                            </button>
                        </form>
                    </td>
                </tr>
                }
                </tbody>
            </table>
            }
            else if (Model.TableToRender == "roles")
            {
            <h2>Administration des rôles</h2>
            <table class="table table-dark table-striped table-hover w-100">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Nom</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                @foreach (var role in Model.Roles)
                {
                    var formRoleId = $"delete-form-{role.RoleId}";
                    <tr>
                        <td>@role.RoleId</td>
                        <td>@role.RoleName</td>
                        <td>
                            <a asp-page="/RoleUpdate" asp-route-id="@role.RoleId" title="Mettre à jour" class="btn-dark me-2">
                                <i class="fas fa-edit"></i>
                            </a>
                            <form id="@formRoleId" method="post" asp-page-handler="DeleteUser">
                                <input type="hidden" name="userId" value="@role.RoleId"/>
                                <button type="button" class="btn btn-dark" onclick="confirmDelete('@formRoleId')">
                                    <i class="fas fa-times"></i>
                                </button>
                            </form>
                        </td>
                    </tr>
                }
                </tbody>
            </table>
            }
            @*else if (Model.TableToRender == "gamedatas")
            {
            <h2>Administration des sauvegardes</h2>
            <table class="table table-dark table-striped table-hover w-100">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Gold</th>
                    <th>UserId</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                @foreach (var gamedata in Model.GameData)
                {
                var formGameDateId = $"delete-form-{gamedata.GameDataId}";
                <tr>
                    <td>@gamedata.GameDataId</td>
                    <td>@gamedata.Gold</td>
                    <td>@gamedata.UserId</td>
                    <td>
                        <a asp-page="/GamaDataUpdate" asp-route-id="@gamedata.GameDataId" asp-route-username="@.RoleName" title="Mettre à jour" class="btn-dark me-2">
                            <i class="fas fa-edit"></i>
                        </a>
                        <form id="@formGameDateId" method="post" asp-page-handler="DeleteUser">
                            <input type="hidden" name="userId" value="@gamedata.GameDataId"/>
                            <button type="button" class="btn btn-dark" onclick="confirmDelete('@formGameDateId')">
                                <i class="fas fa-times"></i>
                            </button>
                        </form>
                    </td>
                </tr>
                }
                </tbody>
            </table>
            }*@
        </div>
    </div>
</div>

<script>
    function confirmDelete(formUserId) {
        if (confirm("Voulez-vous vraiment supprimer cet utilisateur ?")) {
            document.getElementById(formUserId).submit();
        }
    }
    function confirmDelete(formRoleId) {
        if (confirm("Voulez-vous vraiment supprimer ce rôle ?")) {
            document.getElementById(formRoleId).submit();
        }
    }
    function confirmDelete(formGameDateId) {
        if (confirm("Voulez-vous vraiment supprimer cette sauvegarde ?")) {
            document.getElementById(formGameDateId).submit();
        }
    }
</script>